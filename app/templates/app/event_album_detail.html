{% extends 'base.html' %}
{% load static %}
{% block content %}
<h2>{{ album.title }}</h2>
<form id="csrf-form" style="display:none;">
    {% csrf_token %}
</form>
<p>{{ album.description }}</p>
<p><b>–î–∞—Ç–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:</b> {{ album.event_date }}</p>

{% if user.is_authenticated %}
    <a href="{% url 'add_event_photo' album.pk %}" class="btn btn-success mb-3">–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</a>
    <a href="{% url 'add_event_comment' album.pk %}" class="btn btn-primary mb-3">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</a>
{% endif %}

<div class="reactions mb-3">
    <button class="btn btn-outline-success reaction-btn"
            data-type="like"
            data-content-type="{{ album_type_id }}"
            data-object-id="{{ album.id }}">
        üëç <span class="likes-count">{{ album.likes }}</span>
    </button>
    <button class="btn btn-outline-danger reaction-btn"
            data-type="dislike"
            data-content-type="{{ album_type_id }}"
            data-object-id="{{ album.id }}">
        üëé <span class="dislikes-count">{{ album.dislikes }}</span>
    </button>
</div>

<h4>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</h4>
<div class="row">
    {% for photo in photos %}
        <div class="col-md-3 mb-3">
            <img src="{{ photo.photo.url }}" class="img-fluid rounded" alt="{{ photo.caption }}">
            {% if photo.caption %}
                <p class="text-center">{{ photo.caption }}</p>
            {% endif %}
            <div class="reactions mb-2">
                <button class="btn btn-sm btn-outline-success reaction-btn"
                        data-type="like"
                        data-content-type="{{ photo_type_id }}"
                        data-object-id="{{ photo.id }}">
                    <i class="fas fa-thumbs-up"></i>
                    <span class="likes-count">{{ photo.likes }}</span>
                </button>
                <button class="btn btn-sm btn-outline-danger reaction-btn"
                        data-type="dislike"
                        data-content-type="{{ photo_type_id }}"
                        data-object-id="{{ photo.id }}">
                    <i class="fas fa-thumbs-down"></i>
                    <span class="dislikes-count">{{ photo.dislikes }}</span>
                </button>
            </div>
            <a href="{% url 'add_photo_comment' photo.id %}" class="btn btn-primary btn-sm mt-2">–ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
        </div>
    {% empty %}
        <p>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –ø–æ–∫–∞ –Ω–µ—Ç.</p>
    {% endfor %}
</div>

<h4>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h4>
<ul>
    {% for comment in comments %}
        <li>{{ comment.author.username }}: {{ comment.text }} ({{ comment.created_at|date:"d.m.Y H:i" }})</li>
    {% empty %}
        <li>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</li>
    {% endfor %}
</ul>
<a href="{% url 'event_albums_list' %}" class="btn btn-secondary mt-3">–ù–∞–∑–∞–¥ –∫ –∞–ª—å–±–æ–º–∞–º</a>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<script src="{% static 'js/reactions.js' %}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    initReactions("{% if user.is_authenticated %}true{% else %}false{% endif %}", "{% url 'login' %}");
});
</script>
{% endblock %}
